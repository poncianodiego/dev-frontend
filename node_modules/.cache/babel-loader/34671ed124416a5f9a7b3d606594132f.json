{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useLiquityReducer = void 0;\n\nconst react_1 = require(\"react\");\n\nconst equals_1 = require(\"../utils/equals\");\n\nconst useLiquityStore_1 = require(\"./useLiquityStore\");\n\nconst useLiquityReducer = (reduce, init) => {\n  const store = useLiquityStore_1.useLiquityStore();\n  const oldStore = react_1.useRef(store);\n  const state = react_1.useRef(init(store.state));\n  const [, rerender] = react_1.useReducer(() => ({}), {});\n  const dispatch = react_1.useCallback(action => {\n    const newState = reduce(state.current, action);\n\n    if (!equals_1.equals(newState, state.current)) {\n      state.current = newState;\n      rerender();\n    }\n  }, [reduce]);\n  react_1.useEffect(() => store.subscribe(params => dispatch({\n    type: \"updateStore\",\n    ...params\n  })), [store, dispatch]);\n\n  if (oldStore.current !== store) {\n    state.current = init(store.state);\n    oldStore.current = store;\n  }\n\n  return [state.current, dispatch];\n};\n\nexports.useLiquityReducer = useLiquityReducer;","map":{"version":3,"sources":["../../../src/hooks/useLiquityReducer.ts"],"names":[],"mappings":";;;;;;;AAAA,MAAA,OAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAIA,MAAA,QAAA,GAAA,OAAA,CAAA,iBAAA,CAAA;;AACA,MAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AASO,MAAM,iBAAiB,GAAG,CAC/B,MAD+B,EAE/B,IAF+B,KAGqB;AACpD,QAAM,KAAK,GAAG,iBAAA,CAAA,eAAA,EAAd;AACA,QAAM,QAAQ,GAAG,OAAA,CAAA,MAAA,CAAO,KAAP,CAAjB;AACA,QAAM,KAAK,GAAG,OAAA,CAAA,MAAA,CAAO,IAAI,CAAC,KAAK,CAAC,KAAP,CAAX,CAAd;AACA,QAAM,GAAG,QAAH,IAAe,OAAA,CAAA,UAAA,CAAW,OAAO,EAAP,CAAX,EAAuB,EAAvB,CAArB;AAEA,QAAM,QAAQ,GAAG,OAAA,CAAA,WAAA,CACd,MAAD,IAAsC;AACpC,UAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,OAAP,EAAgB,MAAhB,CAAvB;;AAEA,QAAI,CAAC,QAAA,CAAA,MAAA,CAAO,QAAP,EAAiB,KAAK,CAAC,OAAvB,CAAL,EAAsC;AACpC,MAAA,KAAK,CAAC,OAAN,GAAgB,QAAhB;AACA,MAAA,QAAQ;AACT;AACF,GARc,EASf,CAAC,MAAD,CATe,CAAjB;AAYA,EAAA,OAAA,CAAA,SAAA,CAAU,MAAM,KAAK,CAAC,SAAN,CAAgB,MAAM,IAAI,QAAQ,CAAC;AAAE,IAAA,IAAI,EAAE,aAAR;AAAuB,OAAG;AAA1B,GAAD,CAAlC,CAAhB,EAAyF,CACvF,KADuF,EAEvF,QAFuF,CAAzF;;AAKA,MAAI,QAAQ,CAAC,OAAT,KAAqB,KAAzB,EAAgC;AAC9B,IAAA,KAAK,CAAC,OAAN,GAAgB,IAAI,CAAC,KAAK,CAAC,KAAP,CAApB;AACA,IAAA,QAAQ,CAAC,OAAT,GAAmB,KAAnB;AACD;;AAED,SAAO,CAAC,KAAK,CAAC,OAAP,EAAgB,QAAhB,CAAP;AACD,CAhCM;;AAAM,OAAA,CAAA,iBAAA,GAAiB,iBAAjB","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useLiquityReducer = void 0;\nconst react_1 = require(\"react\");\nconst equals_1 = require(\"../utils/equals\");\nconst useLiquityStore_1 = require(\"./useLiquityStore\");\nconst useLiquityReducer = (reduce, init) => {\n    const store = useLiquityStore_1.useLiquityStore();\n    const oldStore = react_1.useRef(store);\n    const state = react_1.useRef(init(store.state));\n    const [, rerender] = react_1.useReducer(() => ({}), {});\n    const dispatch = react_1.useCallback((action) => {\n        const newState = reduce(state.current, action);\n        if (!equals_1.equals(newState, state.current)) {\n            state.current = newState;\n            rerender();\n        }\n    }, [reduce]);\n    react_1.useEffect(() => store.subscribe(params => dispatch({ type: \"updateStore\", ...params })), [\n        store,\n        dispatch\n    ]);\n    if (oldStore.current !== store) {\n        state.current = init(store.state);\n        oldStore.current = store;\n    }\n    return [state.current, dispatch];\n};\nexports.useLiquityReducer = useLiquityReducer;\n//# sourceMappingURL=useLiquityReducer.js.map"]},"metadata":{},"sourceType":"script"}
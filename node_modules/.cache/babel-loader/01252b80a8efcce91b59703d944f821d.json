{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"/Users/diegoponciano/Desktop/ryan/liquity/frontend/packages/dev-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectSpread2\");\n\nvar _slicedToArray = require(\"/Users/diegoponciano/Desktop/ryan/liquity/frontend/packages/dev-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useLiquityReducer = void 0;\n\nvar react_1 = require(\"react\");\n\nvar equals_1 = require(\"../utils/equals\");\n\nvar useLiquityStore_1 = require(\"./useLiquityStore\");\n\nvar useLiquityReducer = function useLiquityReducer(reduce, init) {\n  var store = useLiquityStore_1.useLiquityStore();\n  var oldStore = react_1.useRef(store);\n  var state = react_1.useRef(init(store.state));\n\n  var _react_1$useReducer = react_1.useReducer(function () {\n    return {};\n  }, {}),\n      _react_1$useReducer2 = _slicedToArray(_react_1$useReducer, 2),\n      rerender = _react_1$useReducer2[1];\n\n  var dispatch = react_1.useCallback(function (action) {\n    var newState = reduce(state.current, action);\n\n    if (!equals_1.equals(newState, state.current)) {\n      state.current = newState;\n      rerender();\n    }\n  }, [reduce]);\n  react_1.useEffect(function () {\n    return store.subscribe(function (params) {\n      return dispatch(_objectSpread({\n        type: \"updateStore\"\n      }, params));\n    });\n  }, [store, dispatch]);\n\n  if (oldStore.current !== store) {\n    state.current = init(store.state);\n    oldStore.current = store;\n  }\n\n  return [state.current, dispatch];\n};\n\nexports.useLiquityReducer = useLiquityReducer;","map":{"version":3,"sources":["../../../src/hooks/useLiquityReducer.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,IAAA,OAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAIA,IAAA,QAAA,GAAA,OAAA,CAAA,iBAAA,CAAA;;AACA,IAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AASO,IAAM,iBAAiB,GAAG,SAApB,iBAAoB,CAC/B,MAD+B,EAE/B,IAF+B,EAGqB;AACpD,MAAM,KAAK,GAAG,iBAAA,CAAA,eAAA,EAAd;AACA,MAAM,QAAQ,GAAG,OAAA,CAAA,MAAA,CAAO,KAAP,CAAjB;AACA,MAAM,KAAK,GAAG,OAAA,CAAA,MAAA,CAAO,IAAI,CAAC,KAAK,CAAC,KAAP,CAAX,CAAd;;AAHoD,4BAI/B,OAAA,CAAA,UAAA,CAAW;AAAA,WAAO,EAAP;AAAA,GAAX,EAAuB,EAAvB,CAJ+B;AAAA;AAAA,MAI3C,QAJ2C;;AAMpD,MAAM,QAAQ,GAAG,OAAA,CAAA,WAAA,CACf,UAAC,MAAD,EAAsC;AACpC,QAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,OAAP,EAAgB,MAAhB,CAAvB;;AAEA,QAAI,CAAC,QAAA,CAAA,MAAA,CAAO,QAAP,EAAiB,KAAK,CAAC,OAAvB,CAAL,EAAsC;AACpC,MAAA,KAAK,CAAC,OAAN,GAAgB,QAAhB;AACA,MAAA,QAAQ;AACT;AACF,GARc,EASf,CAAC,MAAD,CATe,CAAjB;AAYA,EAAA,OAAA,CAAA,SAAA,CAAU;AAAA,WAAM,KAAK,CAAC,SAAN,CAAgB,UAAA,MAAM;AAAA,aAAI,QAAQ;AAAG,QAAA,IAAI,EAAE;AAAT,SAA2B,MAA3B,EAAZ;AAAA,KAAtB,CAAN;AAAA,GAAV,EAAyF,CACvF,KADuF,EAEvF,QAFuF,CAAzF;;AAKA,MAAI,QAAQ,CAAC,OAAT,KAAqB,KAAzB,EAAgC;AAC9B,IAAA,KAAK,CAAC,OAAN,GAAgB,IAAI,CAAC,KAAK,CAAC,KAAP,CAApB;AACA,IAAA,QAAQ,CAAC,OAAT,GAAmB,KAAnB;AACD;;AAED,SAAO,CAAC,KAAK,CAAC,OAAP,EAAgB,QAAhB,CAAP;AACD,CAhCM;;AAAM,OAAA,CAAA,iBAAA,GAAiB,iBAAjB","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useLiquityReducer = void 0;\nconst react_1 = require(\"react\");\nconst equals_1 = require(\"../utils/equals\");\nconst useLiquityStore_1 = require(\"./useLiquityStore\");\nconst useLiquityReducer = (reduce, init) => {\n    const store = useLiquityStore_1.useLiquityStore();\n    const oldStore = react_1.useRef(store);\n    const state = react_1.useRef(init(store.state));\n    const [, rerender] = react_1.useReducer(() => ({}), {});\n    const dispatch = react_1.useCallback((action) => {\n        const newState = reduce(state.current, action);\n        if (!equals_1.equals(newState, state.current)) {\n            state.current = newState;\n            rerender();\n        }\n    }, [reduce]);\n    react_1.useEffect(() => store.subscribe(params => dispatch({ type: \"updateStore\", ...params })), [\n        store,\n        dispatch\n    ]);\n    if (oldStore.current !== store) {\n        state.current = init(store.state);\n        oldStore.current = store;\n    }\n    return [state.current, dispatch];\n};\nexports.useLiquityReducer = useLiquityReducer;\n//# sourceMappingURL=useLiquityReducer.js.map"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"import{COIN}from\"../../../strings\";import{Amount}from\"../../ActionDescription\";import{ErrorDescription}from\"../../ErrorDescription\";import{StabilityActionDescription}from\"../StabilityActionDescription\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var selectForStabilityDepositChangeValidation=function selectForStabilityDepositChangeValidation(_ref){var trove=_ref.trove,lusdBalance=_ref.lusdBalance,ownFrontend=_ref.ownFrontend,haveUndercollateralizedTroves=_ref.haveUndercollateralizedTroves;return{trove:trove,lusdBalance:lusdBalance,haveOwnFrontend:ownFrontend.status===\"registered\",haveUndercollateralizedTroves:haveUndercollateralizedTroves};};export var validateStabilityDepositChange=function validateStabilityDepositChange(originalDeposit,editedLUSD,_ref2){var _change$depositLUSD;var lusdBalance=_ref2.lusdBalance,haveOwnFrontend=_ref2.haveOwnFrontend,haveUndercollateralizedTroves=_ref2.haveUndercollateralizedTroves;var change=originalDeposit.whatChanged(editedLUSD);if(haveOwnFrontend){return[undefined,/*#__PURE__*/_jsx(ErrorDescription,{children:\"You can\\u2019t deposit using a wallet address that is registered as a frontend.\"})];}if(!change){return[undefined,undefined];}if((_change$depositLUSD=change.depositLUSD)===null||_change$depositLUSD===void 0?void 0:_change$depositLUSD.gt(lusdBalance)){return[undefined,/*#__PURE__*/_jsxs(ErrorDescription,{children:[\"The amount you're trying to deposit exceeds your balance by\",\" \",/*#__PURE__*/_jsxs(Amount,{children:[change.depositLUSD.sub(lusdBalance).prettify(),\" \",COIN]}),\".\"]})];}if(change.withdrawLUSD&&haveUndercollateralizedTroves){return[undefined,/*#__PURE__*/_jsx(ErrorDescription,{children:\"You're not allowed to withdraw LUSD from your Stability Deposit when there are undercollateralized Troves. Please liquidate those Troves or try again later.\"})];}return[change,/*#__PURE__*/_jsx(StabilityActionDescription,{originalDeposit:originalDeposit,change:change})];};","map":{"version":3,"sources":["/Users/diegoponciano/Desktop/ryan/liquity/frontend/packages/dev-frontend/src/components/Stability/validation/validateStabilityDepositChange.tsx"],"names":["COIN","Amount","ErrorDescription","StabilityActionDescription","selectForStabilityDepositChangeValidation","trove","lusdBalance","ownFrontend","haveUndercollateralizedTroves","haveOwnFrontend","status","validateStabilityDepositChange","originalDeposit","editedLUSD","change","whatChanged","undefined","depositLUSD","gt","sub","prettify","withdrawLUSD"],"mappings":"AAOA,OAASA,IAAT,KAAqB,kBAArB,CACA,OAASC,MAAT,KAAuB,yBAAvB,CACA,OAASC,gBAAT,KAAiC,wBAAjC,CACA,OAASC,0BAAT,KAA2C,+BAA3C,C,wFAEA,MAAO,IAAMC,CAAAA,yCAAyC,CAAG,QAA5CA,CAAAA,yCAA4C,UACvDC,CAAAA,KADuD,MACvDA,KADuD,CAEvDC,WAFuD,MAEvDA,WAFuD,CAGvDC,WAHuD,MAGvDA,WAHuD,CAIvDC,6BAJuD,MAIvDA,6BAJuD,OAK/B,CACxBH,KAAK,CAALA,KADwB,CAExBC,WAAW,CAAXA,WAFwB,CAGxBG,eAAe,CAAEF,WAAW,CAACG,MAAZ,GAAuB,YAHhB,CAIxBF,6BAA6B,CAA7BA,6BAJwB,CAL+B,EAAlD,CAgBP,MAAO,IAAMG,CAAAA,8BAA8B,CAAG,QAAjCA,CAAAA,8BAAiC,CAC5CC,eAD4C,CAE5CC,UAF4C,OAWzC,4BAPDP,CAAAA,WAOC,OAPDA,WAOC,CANDG,eAMC,OANDA,eAMC,CALDD,6BAKC,OALDA,6BAKC,CACH,GAAMM,CAAAA,MAAM,CAAGF,eAAe,CAACG,WAAhB,CAA4BF,UAA5B,CAAf,CAEA,GAAIJ,eAAJ,CAAqB,CACnB,MAAO,CACLO,SADK,cAEL,KAAC,gBAAD,8FAFK,CAAP,CAMD,CAED,GAAI,CAACF,MAAL,CAAa,CACX,MAAO,CAACE,SAAD,CAAYA,SAAZ,CAAP,CACD,CAED,wBAAIF,MAAM,CAACG,WAAX,8CAAI,oBAAoBC,EAApB,CAAuBZ,WAAvB,CAAJ,CAAyC,CACvC,MAAO,CACLU,SADK,cAEL,MAAC,gBAAD,0EAC8D,GAD9D,cAEE,MAAC,MAAD,YACGF,MAAM,CAACG,WAAP,CAAmBE,GAAnB,CAAuBb,WAAvB,EAAoCc,QAApC,EADH,KACoDpB,IADpD,GAFF,OAFK,CAAP,CAUD,CAED,GAAIc,MAAM,CAACO,YAAP,EAAuBb,6BAA3B,CAA0D,CACxD,MAAO,CACLQ,SADK,cAEL,KAAC,gBAAD,2KAFK,CAAP,CAOD,CAED,MAAO,CAACF,MAAD,cAAS,KAAC,0BAAD,EAA4B,eAAe,CAAEF,eAA7C,CAA8D,MAAM,CAAEE,MAAtE,EAAT,CAAP,CACD,CAnDM","sourcesContent":["import {\n  Decimal,\n  LiquityStoreState,\n  StabilityDeposit,\n  StabilityDepositChange\n} from \"@liquity/lib-base\";\n\nimport { COIN } from \"../../../strings\";\nimport { Amount } from \"../../ActionDescription\";\nimport { ErrorDescription } from \"../../ErrorDescription\";\nimport { StabilityActionDescription } from \"../StabilityActionDescription\";\n\nexport const selectForStabilityDepositChangeValidation = ({\n  trove,\n  lusdBalance,\n  ownFrontend,\n  haveUndercollateralizedTroves\n}: LiquityStoreState) => ({\n  trove,\n  lusdBalance,\n  haveOwnFrontend: ownFrontend.status === \"registered\",\n  haveUndercollateralizedTroves\n});\n\ntype StabilityDepositChangeValidationContext = ReturnType<\n  typeof selectForStabilityDepositChangeValidation\n>;\n\nexport const validateStabilityDepositChange = (\n  originalDeposit: StabilityDeposit,\n  editedLUSD: Decimal,\n  {\n    lusdBalance,\n    haveOwnFrontend,\n    haveUndercollateralizedTroves\n  }: StabilityDepositChangeValidationContext\n): [\n  validChange: StabilityDepositChange<Decimal> | undefined,\n  description: JSX.Element | undefined\n] => {\n  const change = originalDeposit.whatChanged(editedLUSD);\n\n  if (haveOwnFrontend) {\n    return [\n      undefined,\n      <ErrorDescription>\n        You canâ€™t deposit using a wallet address that is registered as a frontend.\n      </ErrorDescription>\n    ];\n  }\n\n  if (!change) {\n    return [undefined, undefined];\n  }\n\n  if (change.depositLUSD?.gt(lusdBalance)) {\n    return [\n      undefined,\n      <ErrorDescription>\n        The amount you're trying to deposit exceeds your balance by{\" \"}\n        <Amount>\n          {change.depositLUSD.sub(lusdBalance).prettify()} {COIN}\n        </Amount>\n        .\n      </ErrorDescription>\n    ];\n  }\n\n  if (change.withdrawLUSD && haveUndercollateralizedTroves) {\n    return [\n      undefined,\n      <ErrorDescription>\n        You're not allowed to withdraw LUSD from your Stability Deposit when there are\n        undercollateralized Troves. Please liquidate those Troves or try again later.\n      </ErrorDescription>\n    ];\n  }\n\n  return [change, <StabilityActionDescription originalDeposit={originalDeposit} change={change} />];\n};\n"]},"metadata":{},"sourceType":"module"}